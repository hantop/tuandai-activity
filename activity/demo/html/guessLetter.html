<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no" />
    <!-- <meta name="viewport" content="width=750, user-scalable=0,  shrink-to-fit=no, target-desityDpi=device-dpi" /> -->
    <meta name="format-detection" content="telephone=no">
    <title>demo</title>
    <!-- build:css(dist) ../css/main.css -->
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/media.css">
    <link rel="stylesheet" href="../css/animation.css">
    <!-- endbuild -->
    <script>
    // window.location.href = 'page2.html';
    </script>
</head>

<body>
    <div>
        <canvas id="canvas" width="500" height="300">
            your browser does not support HTML5 Canvas
        </canvas>
        <form >
        	<input type="button" id="createImageData" value="Export Canvas Image">
        </form>
    </div>
    <!-- <embed id="plugin" src="../music/css.pdf" /> -->
</body>
<!-- build:js({dist}) ../js/lib/fastclick-jquery.js -->
<script src="../js/fastclick-jquery.js" type="text/javascript" charset="utf-8"></script>
<!-- endbuild -->
<script>
(function() {
	var canvas = document.getElementById("canvas"); 
    var context = canvas.getContext('2d');
    var guesses = 0,
        message = "Guess The Letter From a (lower)to z (higher)",
        letters = ["a", "b", "c", "d", "e", "f", "g", "h", "i", 'j', "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"],
        today = new Date(),
        letterToGuess = "",
        higherOrLower = "",
        lettersGuessed,
        gameOver = false;
    canvasApp();
    exportCanvas();


    function exportCanvas () {
    	var formElement = document.getElementById("createImageData");
    	formElement.addEventListener('click', createImageDataPressed, false);
    }

    function createImageDataPressed (e) {
    	window.open(canvas.toDataURL(), "canvasImage", "left=0,top=0,width=" + canvas.width + ",height=" + canvas.height + ",toolbar=0,resizable=0");
    }

    function canvasSupport() {
        return !!document.createElement('canvas').getContext;
    }

    function canvasApp() {
        if (!canvasSupport()) {
            return;
        }


        initGame();
    }

    function initGame() {
        var letterIndex = Math.floor(Math.random() * letters.length);
        letterToGuess = letters[letterIndex];
        guesses = 0;
        lettersGuessed = [];
        gameOver = false;
        window.addEventListener("keydown", eventKeyPressed, true);
        drawScreen();
    }

    function eventKeyPressed(e) {
        if (!gameOver) {
            var letterPressed = String.fromCharCode(e.keyCode);
            letterPressed = letterPressed.toLowerCase();
            guesses++;
            lettersGuessed.push(letterPressed);

            if (letterPressed == letterToGuess) {
                gameOver = true;
            } else {
                letterIndex = letters.indexOf(letterToGuess);
                guessIndex = letters.indexOf(letterPressed);
                Debugger.log(guessIndex);
                if (guessIndex < 0) {
                    higherOrLower = "That is not a letter";
                } else if (guessIndex > letterIndex) {
                    higherOrLower = "Lower";
                } else {
                    higherOrLower = "Higher";
                }
            }
            drawScreen();
        }
    }

    function drawScreen() {
        // 北京
        context.fillStyle = "#ffffaa";
        context.fillRect(0, 0, 500, 300);
        // 边框
        context.strokeStyle = "#000";
        context.strokeRect(5, 5, 490, 290);

        context.textBaseline = "top";
        // 日期
        context.fillStyle = "#000";
        context.font = "10px Sans-Serif";
        context.fillText(today, 150, 10);
        // 消息
        context, fillStyle = "#ff0000";
        context.font = "14px Sans-Serif";
        context.fillText(message, 125, 30);
        // 猜测次数
        context.fillStyle = "#109910";
        context.font = "16px Sans-Serif";
        context.fillText('Guesses: ' + guesses, 215, 50);
        // 显示Higher或Lower
        context.fillStyle = "#000";
        context.font = "16px Sans-Serif";
        context.fillText("Higher Or Lower: " + higherOrLower, 150, 125);
        // 猜过的字母
        context.fillStyle = "#ff0000";
        context.font = "16px Sans-Serif";
        context.fillText("Letters Guessed: " + lettersGuessed.toString(), 10, 260);

        if (gameOver) {
            context.fillStyle = "#ff0000";
            context.font = "40px _sans-serif";
            context.fillText("You Got It!", 150, 180);
        }

    }

    var Debugger = function() {};
    Debugger.log = function(message) {
        try {
            console.log(message);
        } catch (exception) {
            return;
        }
    }
})()
</script>

</html>
